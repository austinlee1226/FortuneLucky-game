<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å‰é‹è‡¨é–€ - 2026 ä½ çš„é–‹é‹ç±¤è©©</title>
    <style>
        :root { --bg-red: #b71c1c; --gold: #ffd700; --paper: #fffdf5; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background-color: #1a1a1a; margin: 0; display: flex; justify-content: center; align-items: center; height: 100dvh; font-family: -apple-system, "Microsoft JhengHei", sans-serif; overflow: hidden; }
        .game-wrapper { position: relative; background-color: var(--bg-red); width: 100%; max-width: 430px; height: 100%; display: flex; flex-direction: column; align-items: center; padding: 10px; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        .header-section { width: 100%; height: 15dvh; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .content-section { position: relative; width: 100%; height: 65dvh; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 50; }
        .footer-section { width: 100%; height: 120px; display: flex; flex-direction: column; align-items: center; justify-content: flex-start; z-index: 1000; }
        .title-group { display: grid; place-items: center; width: 100%; height: 80px; position: relative; }
        .title { grid-area: 1 / 1; color: var(--gold); font-size: 1.8rem; letter-spacing: 5px; margin: 0; z-index: 10; }
        .win-info-wrapper { grid-area: 1 / 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; transform: scale(0); opacity: 0; transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
        .win-info-wrapper.show { transform: scale(1); opacity: 1; }
        .win-banner { background: linear-gradient(90deg, transparent, #ff5252, #ff5252, transparent); color: #ffeb3b; width: 100%; padding: 5px 0; font-size: 1.6rem; font-weight: 900; text-align: center; }
        .win-serial { color: #ffffff; font-size: 1.1rem; font-weight: bold; margin-top: 5px; background: rgba(0,0,0,0.3); padding: 2px 15px; border-radius: 20px; border: 1px solid var(--gold); letter-spacing: 2px; }
        .scroll-container { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); width: 92%; height: 95%; background: var(--paper); border: 5px solid #5d4037; border-radius: 12px; padding: 20px 18px; opacity: 0; z-index: 100; transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); display: flex; flex-direction: column; }
        .scroll-container.active { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        .draw-btn-large { background: linear-gradient(180deg, #ffeb3b, #fbc02d); color: #b71c1c; border: none; padding: 16px 60px; font-size: 1.5rem; font-weight: 900; border-radius: 50px; box-shadow: 0 6px 0 #795548; cursor: pointer; }
        .button-group { display: flex; gap: 15px; width: 90%; justify-content: center; opacity: 0; transform: translateY(20px); pointer-events: none; }
        .button-group.show { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .btn-common { flex: 1; background: linear-gradient(180deg, #ffeb3b, #fbc02d); color: #b71c1c; border: none; padding: 12px 0; font-size: 1.1rem; font-weight: 900; border-radius: 30px; box-shadow: 0 4px 0 #795548; cursor: pointer; text-align: center; text-decoration: none; }
        .btn-win-claim { background: linear-gradient(180deg, #ff5252, #b71c1c); color: #ffffff; }
        .btn-copied { background: linear-gradient(180deg, #43a047, #2e7d32) !important; color: white !important; }
        .hidden { display: none !important; }
        .footer-hint { color: white; font-size: 0.85rem; margin-top: 10px; }
        .details-list { text-align: left; padding: 0; list-style: none; margin: 0; overflow-y: auto; }
        .details-list li { padding: 8px 0; border-bottom: 1px dashed #d7ccc8; font-size: 0.95rem; color: #444; opacity: 0; transform: translateY(10px); transition: 0.3s; }
        .details-list li.reveal { opacity: 1; transform: translateY(0); }
        .star-rating { color: var(--gold); font-size: 1.15rem; letter-spacing: 4px; }
        .star-rating span { display: inline-block; transform: scale(0); transition: 0.3s; }
        .star-rating span.pop { transform: scale(1); }
        .shaking { animation: shakeEffect 0.15s infinite; }
        @keyframes shakeEffect { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(7deg); } 75% { transform: rotate(-7deg); } }
    </style>
</head>
<body>
<div class="game-wrapper">
    <input type="text" id="copy-helper" style="position: absolute; left: -9999px;" readonly>

    <div class="header-section">
        <div class="title-group">
            <h1 id="main-title" class="title">å‰é‹è‡¨é–€</h1>
            <div id="win-info" class="win-info-wrapper">
                <div class="win-banner">æ­å–œä¸­ç</div>
                <div id="win-serial" class="win-serial">åºè™Ÿ: --------</div>
            </div>
        </div>
    </div>

    <div class="content-section">
        <div id="cat-actor" style="font-size: 70px;">ğŸ±</div>
        <div id="scroll" class="scroll-container">
            <div style="text-align:center; border-bottom:2px solid #b71c1c; padding-bottom:5px;">
                <div id="res-stars" class="star-rating"></div>
                <h2 id="res-type" style="color:#b71c1c; margin:5px 0;"></h2>
            </div>
            <p id="res-intro" style="font-size:0.9rem; font-weight:bold; margin:10px 0;"></p>
            <ul id="res-details" class="details-list"></ul>
        </div>
    </div>

    <div class="footer-section">
        <button id="init-draw-btn" class="draw-btn-large" onclick="startDrawing()">ç«‹å³æŠ½å¥½é‹</button>
        <div id="after-draw-group" class="button-group">
            <button id="main-action-btn" class="btn-common" onclick="resetUI()">å†æŠ½ä¸€æ¬¡</button>
            <button class="btn-common" onclick="shareToLine()">åˆ†äº«å¥½é‹</button>
        </div>
        <p id="footer-hint-text" class="footer-hint">ä»Šæ—¥é‹å‹¢å¥½ä¸å¥½ï¼Œä¸€æŠ½å°±çŸ¥é“</p>
    </div>
</div>

<script>
    const fortuneData = [
        { star: 5, type: "è¶…å¤§å‰", intro: "èƒ½é‡çˆ†ç™¼æœŸï¼è¬äº‹äº¨é€šã€‚", items: ["â¤ï¸ æ­£ç·£å‡ºç¾", "ğŸ’° è²¡é‹äº¨é€š", "â˜˜ï¸ è²´äººç›¸åŠ©", "ğŸ’¼ æ­¥æ­¥é«˜å‡"] }
    ];

    let currentSerial = "";
    let isCopied = false;
    const LINE_OA_URL = "https://lin.ee/4lqVqd3";

    function startDrawing() {
        document.getElementById('init-draw-btn').classList.add('hidden');
        document.getElementById('cat-actor').classList.add('shaking');
        
        setTimeout(() => {
            document.getElementById('cat-actor').classList.remove('shaking');
            document.getElementById('cat-actor').style.opacity = "0.1";
            showResult(fortuneData[0]); // å¼·åˆ¶å±•ç¤ºè¶…å¤§å‰æ¸¬è©¦
        }, 1500);
    }

    function showResult(pick) {
        currentSerial = Math.random().toString(36).substr(2, 9).toUpperCase();
        document.getElementById('win-serial').innerText = "åºè™Ÿ: " + currentSerial;
        document.getElementById('res-type').innerText = pick.type;
        document.getElementById('res-intro').innerText = pick.intro;
        
        // é¡¯ç¤ºå·è»¸
        document.getElementById('scroll').classList.add('active');
        
        // æ˜Ÿæ˜Ÿå‹•ç•«
        const sCont = document.getElementById('res-stars');
        for(let i=0; i<pick.star; i++) {
            const s = document.createElement('span'); s.innerText="â˜…";
            sCont.appendChild(s);
            setTimeout(() => s.classList.add('pop'), i*200);
        }

        // åˆ—è¡¨å‹•ç•«
        const dCont = document.getElementById('res-details');
        pick.items.forEach((text, i) => {
            const li = document.createElement('li'); li.innerText = text;
            dCont.appendChild(li);
            setTimeout(() => li.classList.add('reveal'), 800 + (i*200));
        });

        // è¨­ç½®é ˜çæŒ‰éˆ• (é—œéµåœ¨æ­¤)
        const mainBtn = document.getElementById('main-action-btn');
        mainBtn.innerText = "è¤‡è£½è¨Šæ¯é ˜ç ğŸ“‹";
        mainBtn.classList.add('btn-win-claim');
        mainBtn.onclick = function() { handleCopy(this); };

        document.getElementById('main-title').style.display = "none";
        document.getElementById('win-info').classList.add('show');
        document.getElementById('after-draw-group').classList.add('show');
    }

    function handleCopy(btn) {
        // ã€ç¢ºå®šæœ‰åŠ å…¥é€™æ®µæ–‡å­—ã€‘
        const msg = "æ‚¨å¥½ï¼æˆ‘æŠ½ä¸­äº†äº”æ˜Ÿè¶…å¤§å‰ï¼é ˜å–åºè™Ÿæ˜¯ï¼š(" + currentSerial + ")";
        
        const helper = document.getElementById('copy-helper');
        helper.value = msg;
        helper.select();
        helper.setSelectionRange(0, 999); // æ‰‹æ©Ÿé¸å–

        try {
            document.execCommand('copy'); // åŸ·è¡Œè¤‡è£½
            isCopied = true;
            btn.innerText = "å‰å¾€ LINE é ˜å– ğŸ";
            btn.classList.add('btn-copied');
            document.getElementById('footer-hint-text').innerText = "âœ… è¨Šæ¯å·²è¤‡è£½ï¼Œè«‹è‡³ LINE è²¼ä¸Šç™¼é€";
            btn.onclick = function() { window.location.href = LINE_OA_URL; };
        } catch (err) {
            alert("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•æˆªåœ–");
        }
    }

    function resetUI() { location.reload(); }
    function shareToLine() {
        const url = "https://line.me/R/msg/text/?" + encodeURIComponent("æˆ‘æŠ½åˆ°äº†è¶…å¤§å‰ï¼å¿«ä¾†è©¦è©¦ï¼š\n" + window.location.href);
        window.location.href = url;
    }
</script>
</body>
</html>